---
title: "The ecological and evolutionary consequences of redlining"
author: "ADD YOUR NAME"
format: 
  html:
    embed-resources: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(messages = FALSE, cache = FALSE)
library(rstac)
library(gdalcubes)
library(stars)
library(tmap)
library(tidyverse)
gdalcubes::gdalcubes_options(parallel = TRUE)
```

## Learning objectives

This module provides an introduction to the fundamentals of working with spatial vector and raster data in R while empirically exploring why systematic and structural racism is intertwined with urban ecological processes. It uses the Simple Features Access standard (ISO 19125) and a tidyverse-style workflow using the sf package and an emerging ecosystem of r-spatial tools.

## Background

In August 2020, [Christopher Schell](https://ourenvironment.berkeley.edu/users/1757114) and colleagues published a review in *Science* on ['The ecological and evolutionary consequences of systemic racism in urban environments'](https://www.science.org/doi/10.1126/science.aay4497) (DOI: 10.1126/science.aay4497), showing how racism and classism has significant impacts on ecological and evolutionary processes within urban environments. Here we explore a subset of the data used to support these findings in this review and the broader literature.

**Figure 2** in the Schell paper shows how NDVI (Normalized Difference Vegetation Index) tracks historical redlining.

![Fig. 1.](figures/fig2.png)

We are going to create maps like these and plot the distributions and mean vegetation patterns across cities to explore the legacy of redlining.

To do this, we are going to use the following spatial data:

#### Mapping Inequality: (vector data)

Please take the time to read the introduction to this dataset [here](https://dsl.richmond.edu/panorama/redlining/#loc=3/41.245/-105.469&text=intro)

#### Normalized Difference Vegetation Index (NDVI) (raster data)

NDVI is used as a proxy measure of vegetation health, cover, and phenology (life cycle stage) over large areas. It is calculated using multiple bands from satellite images.

## Warm-up questions

**Question 1:**

Using the `env-justice-tutorial.qmd` as the template, create a map that shows the current mean NDVI within each grade class polygon in Richmond, VA.

**Answer 1:**

```{r}

```

**Question 2:**

Create a table that displays the mean NDVI for the different grade classifications within Richmond, VA. (one value per grade.)

**Answer 2:**

```{r}


```

## Examining how the influence of redlining varies across city environmental or demographic characteristics

In this section, you are going to examine how the relative difference between the highest grade and lowest grade differs between cities. You will then explore how that difference is related to environmental or demographic differences among the cities.

**Question 3:**

Read in the characteristics of the different cities in the dataset. The characteristics are in the CSV called `data/city_data.csv`. City data was generated by combining <https://simplemaps.com/data/us-cities> with daymet meteorology data (<https://daymet.ornl.gov>)

**Answer 3:**

```{r}


```

**Question 4:**

Pick **five** cities that span a range of environmental or demographic characteristics. 

Select one variable in the data set from Question 3 that 1) interests you and 2) has a large enough range where you see differences across your five selected cities. 

List your five cities, the focal variable, and the range of your variable across your five cities.

**Answer 4:**

```{r}

```

**Question 5:**

Generate a map of NDVI within each class for each city (5 separate plots).

**Answer 5:**

City 1

```{r}
#| echo: false


```

City 2

```{r}
#| echo: false


```

City 3

```{r}
#| echo: false


```

City 4

```{r}
#| echo: false


```

City 5

```{r}
#| echo: false


```

**Question 6:**

Describe any visual differences among the cities in the patterns of NDVI across the classes.

**Answer 6:**


**Question 7:**

Extract the mean NDVI for the different grade classes for each of your five selected cities.

**Answer 7:**

```{r}

```

**Question 8:**

Plot the values for the different classes for the five cities on the same graph (x-axis is class, y-axis is mean NDVI, color is city).

**Answer 8:**

```{r}


```

**Question 9:**

Calculate the relative difference between the lowest and highest class for each city.  Print your results as a table in HTML.

**Answer 9:**

```{r}


```

**Question 10:**

Use a plot to answer the question: Does the relative difference between the highest and lowest classes vary with the environmental or demographic characteristic you choose in Question 3?

**Answer 10:**

```{r}


```

## Citation

This tutorial is an extension of the tutorial created by Carl Boettiger and Millie Chapman at the University of California - Berkeley. <https://boettiger-lab.github.io/nasa-topst-env-justice/tutorials/R/1-intro-R.htm> and <https://github.com/espm-157/spatial-template>

## Attribution

Include citations of any AI-generated assistance or discussion with classmates (per policy in the syllabus). Proper documentation of AI-generated assistance includes the prompt, the source (e.g., ChatGPT), and the significant parts of the response.  Proper documentation of discussion with classmates includes listing their names and the components discussed.  

